!function(e,t){"object"==typeof module&&module.exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):e.CommonTable=t(e.$)}(this,function(e){function t(t,r,a){return this.tableData=null,this.hdrGroups=[],this.headerObjs=[],this.headerElems=[],this.tableElement=e("<table>",{class:"cm-table"}),this.tbodyElement=e("<tbody>").appendTo(this.tableElement),a&&this.tableElement.appendTo(a),t&&this.tableElement.attr("id",t),r&&this.tableElement.attr("class",r),this}return t.prototype.appendTo=function(e){return this.tableElement.appendTo(e),this},t.prototype.prependTo=function(e){return this.tableElement.prependTo(e),this},t.prototype.addColumn=function(e,t,r,a,o,n,l){return e.hasOwnProperty("title")&&e.hasOwnProperty("key")&&!t&&!r?(e.group||(e.group=null),this.headerObjs.push(e)):(e||(e=null),this.headerObjs.push({group:e,title:t,key:r,dateFormat:a,hdrStyles:o,colStyles:n,onClick:l})),this},t.prototype.createHeaders=function(t,r){this.tbodyElement.html("");for(var a=[e("<tr>",{"cm-table-rowtype":"header-row"}).appendTo(this.tbodyElement),e("<tr>",{"cm-table-rowtype":"header-row"}).appendTo(this.tbodyElement)],o=null,n=null,l=0;l<this.headerObjs.length;l++){var s=this.headerObjs[l];s.group&&(o&&s.group===o?n.attr("colspan",1+parseInt(n.attr("colspan"))):(o=s.group,n=e("<th>",{html:s.group,style:"text-align:center;",colspan:1,"cm-table-celltype":"header-group"}).appendTo(a[0])));var i=e("<th>",{html:s.title,"cm-table-celltype":"header"}),h={};if(s.colStyles)for(var p in s.colStyles)h[p]=s.colStyles[p];if(s.hdrStyles)for(var p in s.hdrStyles)h[p]=s.hdrStyles[p];i.css(h);var d=t&&t===s.key;d&&i.append(e("<i>",{class:"icon-"+(r?"ascending":"descending")}));var c=this;i.css("cursor","pointer").on("click",function(e,t){return function(r){r.stopPropagation(),c.populateTable(null,e,t)}}(s.key,!d||!r)),s.group?a[1].append(i):(i.attr("rowspan",2),a[0].append(i))}return a[1][0].hasChildNodes()||(a[1].remove(),a[0].find("th").attr("rowspan",1)),this},t.prototype.populateTable=function(t,r,a,o){this.createHeaders(r,a),t&&(this.tableData=t);var n=this.tableData;if(r&&n.length){var n=this.tableData.slice();n.sort(function(e,t){var o=0,n=[e[r],t[r]],l=[void 0===n[0],void 0===n[1]];if(l[0]!==l[1])o=l[0]?-1:1;else if(!l[0])if("number"==typeof n[0]&&"number"==typeof n[1])o=n[0]-n[1];else{var s=[Date.parse(n[0]),Date.parse(n[1])];o=isNaN(s[0])||isNaN(s[0])?n[0].localeCompare(n[1]):s[0]-s[1]}return a?o:-o})}for(var l=0;l<n.length;l++)for(var s=e("<tr>",{"cm-table-rowtype":"data"}).appendTo(this.tbodyElement),i=0;i<this.headerObjs.length;i++){var h=n[l][this.headerObjs[i].key];if(this.headerObjs[i].dateFormat)try{h=o(h,this.headerObjs[i].dateFormat)}catch(e){}var p=e("<td>",{"cm-table-celltype":"data"}).appendTo(s);this.headerObjs[i].colStyles&&p.css(this.headerObjs[i].colStyles),this.headerObjs[i].onClick?e("<a>",{href:"#",html:h}).appendTo(p).on("click",function(e,t){return function(r){e(t)}}(this.headerObjs[i].onClick,n[l])):p.html(h)}return this},t});